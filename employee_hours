WITH employee_hours AS (
    
    SELECT e.id AS employee_id,
           e.first_name,
           e.last_name,
           SUM(t.hours_worked) AS total_hours,
           ROUND(AVG(t.hours_worked),2) AS avg_hours_per_project
    FROM employees e
    JOIN time_tracking t ON e.id = t.employee_id
    GROUP BY e.id, e.first_name, e.last_name
)
select*from employee_hours ;
